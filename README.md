# MGTCF
The code of "MGTCF: Multi-Generator Tropical Cyclone Forecasting with Heterogeneous Meteorological Data" accepted by AAAI2023.

This [paper](https://ojs.aaai.org/index.php/AAAI/article/view/25638) has been published.

## Introduction

![***MGTCF_framework***](https://github.com/Zjut-MultimediaPlus/MGTCF/tree/main/image/framework.jpg)


Contribution:
1.  MGTCF can utilize heterogeneous meteorologic data efficiently, including the inherent attribute data of TC and the meteorological grid data.
2. The Multi-generator and the GC-Net are used to tackle the prediction of undesired out-of-distribution samples and the insufficient learning ability of single-generator TC prediction methods. 
3. Env-Net improves the performance of TC prediction by embedding the environment information, which has been traditionally overlooked but is very important. To our knowledge, this is the first attempt to build a module focused on environment in TC prediction.
4. Extensive experiments were conducted on the China Meteorological Administration Tropical Cyclone Best Track Dataset (CMA-BST). 
We obtained state-of-the-art performance in deep learning methods and obtained better results than the method of the CMO in most indexes.

The visualization of experiments:

To more intuitively prove the effectiveness of our method, we
visualized the results of trajectory prediction and compared
the prediction performances of MGTCF and the previous
best deep learning method, MMSTN.
As shown in the image below, the red circle points sequence represents the real trajectory, the semitransparent green region
represents the potential tendencies calculated by our multiple trajectory predictions, the semitransparent red region
represents the potential tendencies of MMSTN, the green
star sequence represents the most accurate prediction trajectory generated by our method, and the background of prediction results represents the satellite cloud image of each TC.

![***cone of probability***](https://github.com/Zjut-MultimediaPlus/MGTCF/tree/main/image/example.png)

As for the calculation of evaluation criteria, we choose the **best prediction** through these k possible tendencies (including every time point) as our final prediction.


## Requirements 
* python 3.8.5
* Pytorch 1.11.0
* CUDA 11.7

## Data Preparation
First, you need to download all the data that we used in MGTCF by [Baidu Netdisk](https://pan.baidu.com/s/1qLEVymQ3ivvqAbgGBNkgaQ?pwd=rgwn ) and [Google Drive](https://drive.google.com/file/d/1AZhiGk-cTvcMdL9jerL25KmTzqD8Kab-/view?usp=sharing).

After you complete the downloading, you will find there is a compressed file, which includes Data_1d (Folder name: **1950_2019**), Data_2d (Folder name: **geopotential_500_year_centercrop**), Env-Data (Folder name: **env_data**), and a documentary (file name: [**README.pdf**](https://github.com/Zjut-MultimediaPlus/MGTCF/blob/main/README.pdf)) including some details about these data.

Then, you need to move the Folder **1950_2019** to the **datasets** under the main folder of this project and the **datasets** under the folder **scripts** and correct the path of **geopotential_500_year_centercrop** and the **env_data** in line 302(env_data) and line 309(Data_2d). 

## Train
```python
##before train##
python -m visdom.server
##custom train##
python train.py
```
## Test
```python
## test on data of the year 2019##
python evaluate_model_ME.py --dset_type test2019
```
## Training new models
Instructions for training new models can be [found here](https://github.com/Zjut-MultimediaPlus/MGTCF/blob/main/TRAINING.md).

## The data we used
We used two open-access dataset: [the CMA Tropical Cyclone Best Track Dataset](https://tcdata.typhoon.org.cn/en/zjljsjj_sm.html) 
, [ERA5](https://www.ecmwf.int/en/forecasts/dataset/ecmwf-reanalysis-v5) 
and the results of [the CMO's tropical cyclone predictions](http://typhoon.nmc.cn/web.html).

If you want to use these data, we upload them on [Baidu Netdisk](https://pan.baidu.com/s/1qLEVymQ3ivvqAbgGBNkgaQ?pwd=rgwn ) and [Google Drive](https://drive.google.com/file/d/1AZhiGk-cTvcMdL9jerL25KmTzqD8Kab-/view?usp=sharing).
.

If you are interested in these data, you can click [the CMA Tropical Cyclone Best Track Dataset](https://tcdata.typhoon.org.cn/en/zjljsjj_sm.html), [ERA5](https://www.ecmwf.int/en/forecasts/dataset/ecmwf-reanalysis-v5), and
[the CMO's tropical cyclone data](http://typhoon.nmc.cn/web.html) to obtain more details. 



## Note
Although MGTCF gets a surprising performance, there are some challenges in the task of tropical cyclone forecasting. First, the performance of trajectory prediction in long term is still worse than the performance of the official meteorological agencies. Second, due to the use of ERA5, which is reanalysis data, MGTCF can not predict TC in real-time. It is a critical problem that determines whether our research can be implemented in industry. Therefore, the next step is to continue to improve the performance of forecasting and find a solution to make our method predict TC in real-time.

Our codes were modified from the implementation of ["MMSTN: a Multi-Modal Spatial-Temporal Network for Tropical Cyclone Short-Term Prediction"](https://github.com/Zjut-MultimediaPlus/MMSTN). Please cite the two papers (MGTCF and MMSTN) when you use the codes.
## Citing MGTCF & MMSTN
```
@inproceedings{MGTCF,
  title={MGTCF: Multi-Generator Tropical Cyclone Forecasting with Heterogeneous Meteorological Data},
  author={Huang, Cheng and Bai, Cong and Chan, Sixian and Zhang, Jinglin and Wu, YuQuan},
  booktitle={Proceedings of the AAAI Conference on Artificial Intelligence},
  volume={37},
  number={4},
  pages={5096--5104},
  year={2023}
}
```

```
@article{https://doi.org/10.1029/2021GL096898,
author = {Huang, Cheng and Bai, Cong and Chan, Sixian and Zhang, Jinglin},
title = {MMSTN: A Multi-Modal Spatial-Temporal Network for Tropical Cyclone Short-Term Prediction},
journal = {Geophysical Research Letters},
volume = {49},
number = {4},
pages = {e2021GL096898},
doi = {https://doi.org/10.1029/2021GL096898},
url = {https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2021GL096898},
year = {2022}
}
```
